
(venv) C:\pc\Project>python app.py
🔧 Development environment detected

================================================================================
🚀 Multilingual Tokenization & Inference API v1.0.1
================================================================================
📍 Host: 127.0.0.1:8000
🔧 Debug Mode: True
📊 Log Level: INFO
📝 Log File: logs/api.log
🌐 Languages: hindi, sanskrit, marathi, english
🤖 Model name (fallback): AhinsaAI/ahinsa0.5-llama3.2-3B
📚 Tokenizer (SentencePiece): model/multi_tokenizer.model
⚡ 4-bit Quantization: Enabled
================================================================================
📁 Directory exists: data/training
📁 Directory exists: data/validation
📁 Directory exists: logs
📁 Directory exists: model
2025-09-27 22:00:19,676 - __main__ - INFO - === API Starting - Logging Config Applied ===
C:\pc\Project\app.py:633: DeprecationWarning: 
        on_event is deprecated, use lifespan event handlers instead.

        Read more about it in the
        [FastAPI docs for Lifespan Events](https://fastapi.tiangolo.com/advanced/events/).
        
  @app.on_event("startup")
C:\pc\Project\app.py:638: DeprecationWarning: 
        on_event is deprecated, use lifespan event handlers instead.

        Read more about it in the
        [FastAPI docs for Lifespan Events](https://fastapi.tiangolo.com/advanced/events/).
        
  @app.on_event("shutdown")
INFO:     Will watch for changes in these directories: ['C:\\pc\\Project']
INFO:     Uvicorn running on http://127.0.0.1:8000 (Press CTRL+C to quit)
INFO:     Started reloader process [5508] using StatReload
🔧 Development environment detected

================================================================================
🚀 Multilingual Tokenization & Inference API v1.0.1
================================================================================
📍 Host: 127.0.0.1:8000
🔧 Debug Mode: True
📊 Log Level: INFO
📝 Log File: logs/api.log
🌐 Languages: hindi, sanskrit, marathi, english
🤖 Model name (fallback): AhinsaAI/ahinsa0.5-llama3.2-3B
📚 Tokenizer (SentencePiece): model/multi_tokenizer.model
⚡ 4-bit Quantization: Enabled
================================================================================
📁 Directory exists: data/training
📁 Directory exists: data/validation
📁 Directory exists: logs
📁 Directory exists: model
2025-09-27 22:00:23,561 - __mp_main__ - INFO - === API Starting - Logging Config Applied ===
📁 Directory exists: data/training
📁 Directory exists: data/validation
📁 Directory exists: logs
📁 Directory exists: model
2025-09-27 22:00:23,680 - app - INFO - === API Starting - Logging Config Applied ===
INFO:     Started server process [19804]
INFO:     Waiting for application startup.
2025-09-27 22:00:23,689 - app - INFO - 🚀 API Startup
2025-09-27 22:00:23,694 - app - INFO - ✅ SentencePiece tokenizer loaded from model/multi_tokenizer.model
2025-09-27 22:00:24,681 - app - INFO - 🔧 Using 4-bit quantization for faster inference
`torch_dtype` is deprecated! Use `dtype` instead!
2025-09-27 22:00:25,842 - accelerate.utils.modeling - INFO - We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading checkpoint shards: 100%|███████████████████████████████████████████████████| 2/2 [00:07<00:00,  3.77s/it]
2025-09-27 22:00:34,087 - app - INFO - ✅ Model loaded with 4-bit quantization
2025-09-27 22:00:34,087 - app - INFO - ✅ Model loaded: AhinsaAI/ahinsa0.5-llama3.2-3B
INFO:     Application startup complete.
INFO:     127.0.0.1:59401 - "GET /health HTTP/1.1" 200 OK
Process SpawnProcess-1:
Traceback (most recent call last):
  File "C:\pc\Project\venv\Lib\site-packages\uvicorn\_compat.py", line 23, in asyncio_run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\Users\soham\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\soham\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 640, in run_until_complete
    self.run_forever()
  File "C:\Users\soham\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 607, in run_forever
    self._run_once()
  File "C:\Users\soham\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1884, in _run_once
    event_list = self._selector.select(timeout)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\soham\AppData\Local\Programs\Python\Python311\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\soham\AppData\Local\Programs\Python\Python311\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: too many file descriptors in select()

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\soham\AppData\Local\Programs\Python\Python311\Lib\multiprocessing\process.py", line 314, in _bootstrap
    self.run()
  File "C:\Users\soham\AppData\Local\Programs\Python\Python311\Lib\multiprocessing\process.py", line 108, in run  
    self._target(*self._args, **self._kwargs)
  File "C:\pc\Project\venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
  File "C:\pc\Project\venv\Lib\site-packages\uvicorn\server.py", line 67, in run
    return asyncio_run(self.serve(sockets=sockets), loop_factory=self.config.get_loop_factory())
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\pc\Project\venv\Lib\site-packages\uvicorn\_compat.py", line 22, in asyncio_run
    with asyncio.Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "C:\Users\soham\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 63, in __exit__      
    self.close()
  File "C:\Users\soham\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 71, in close
    _cancel_all_tasks(loop)
  File "C:\Users\soham\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 201, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "C:\Users\soham\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 640, in run_until_complete
    self.run_forever()
  File "C:\Users\soham\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 607, in run_forever
    self._run_once()
  File "C:\Users\soham\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1884, in _run_once
    event_list = self._selector.select(timeout)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\soham\AppData\Local\Programs\Python\Python311\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\soham\AppData\Local\Programs\Python\Python311\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: too many file descriptors in select()
(venv) C:\pc\Project>python app.py
🔧 Development environment detected

================================================================================
🚀 Multilingual Tokenization & Inference API v1.0.1
================================================================================
📍 Host: 127.0.0.1:8000
🔧 Debug Mode: True
📊 Log Level: INFO
📝 Log File: logs/api.log
🌐 Languages: hindi, sanskrit, marathi, english
🤖 Model name (fallback): AhinsaAI/ahinsa0.5-llama3.2-3B
📚 Tokenizer (SentencePiece): model/multi_tokenizer.model
⚡ 4-bit Quantization: Enabled
================================================================================
📁 Directory exists: data/training
📁 Directory exists: data/validation
📁 Directory exists: logs
📁 Directory exists: model
2025-09-27 22:00:19,676 - __main__ - INFO - === API Starting - Logging Config Applied ===
C:\pc\Project\app.py:633: DeprecationWarning: 
        on_event is deprecated, use lifespan event handlers instead.

        Read more about it in the
        [FastAPI docs for Lifespan Events](https://fastapi.tiangolo.com/advanced/events/).
        
  @app.on_event("startup")
C:\pc\Project\app.py:638: DeprecationWarning: 
        on_event is deprecated, use lifespan event handlers instead.

        Read more about it in the
        [FastAPI docs for Lifespan Events](https://fastapi.tiangolo.com/advanced/events/).
        
  @app.on_event("shutdown")
INFO:     Will watch for changes in these directories: ['C:\\pc\\Project']
INFO:     Uvicorn running on http://127.0.0.1:8000 (Press CTRL+C to quit)
INFO:     Started reloader process [5508] using StatReload
🔧 Development environment detected

================================================================================
🚀 Multilingual Tokenization & Inference API v1.0.1
================================================================================
📍 Host: 127.0.0.1:8000
🔧 Debug Mode: True
📊 Log Level: INFO
📝 Log File: logs/api.log
🌐 Languages: hindi, sanskrit, marathi, english
🤖 Model name (fallback): AhinsaAI/ahinsa0.5-llama3.2-3B
📚 Tokenizer (SentencePiece): model/multi_tokenizer.model
⚡ 4-bit Quantization: Enabled
================================================================================
📁 Directory exists: data/training
📁 Directory exists: data/validation
📁 Directory exists: logs
📁 Directory exists: model
2025-09-27 22:00:23,561 - __mp_main__ - INFO - === API Starting - Logging Config Applied ===
📁 Directory exists: data/training
📁 Directory exists: data/validation
📁 Directory exists: logs
📁 Directory exists: model
2025-09-27 22:00:23,680 - app - INFO - === API Starting - Logging Config Applied ===
INFO:     Started server process [19804]
INFO:     Waiting for application startup.
2025-09-27 22:00:23,689 - app - INFO - 🚀 API Startup
2025-09-27 22:00:23,694 - app - INFO - ✅ SentencePiece tokenizer loaded from model/multi_tokenizer.model
2025-09-27 22:00:24,681 - app - INFO - 🔧 Using 4-bit quantization for faster inference
`torch_dtype` is deprecated! Use `dtype` instead!
2025-09-27 22:00:25,842 - accelerate.utils.modeling - INFO - We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading checkpoint shards: 100%|███████████████████████████████████████████████████| 2/2 [00:07<00:00,  3.77s/it]
2025-09-27 22:00:34,087 - app - INFO - ✅ Model loaded with 4-bit quantization
2025-09-27 22:00:34,087 - app - INFO - ✅ Model loaded: AhinsaAI/ahinsa0.5-llama3.2-3B
INFO:     Application startup complete.
INFO:     127.0.0.1:59401 - "GET /health HTTP/1.1" 200 OK
Process SpawnProcess-1:
Traceback (most recent call last):
  File "C:\pc\Project\venv\Lib\site-packages\uvicorn\_compat.py", line 23, in asyncio_run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\Users\soham\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\soham\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 640, in run_until_complete
    self.run_forever()
  File "C:\Users\soham\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 607, in run_forever
    self._run_once()
  File "C:\Users\soham\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1884, in _run_once
    event_list = self._selector.select(timeout)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\soham\AppData\Local\Programs\Python\Python311\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\soham\AppData\Local\Programs\Python\Python311\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: too many file descriptors in select()

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\soham\AppData\Local\Programs\Python\Python311\Lib\multiprocessing\process.py", line 314, in _bootstrap
    self.run()
  File "C:\Users\soham\AppData\Local\Programs\Python\Python311\Lib\multiprocessing\process.py", line 108, in run  
    self._target(*self._args, **self._kwargs)
  File "C:\pc\Project\venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
  File "C:\pc\Project\venv\Lib\site-packages\uvicorn\server.py", line 67, in run
    return asyncio_run(self.serve(sockets=sockets), loop_factory=self.config.get_loop_factory())
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\pc\Project\venv\Lib\site-packages\uvicorn\_compat.py", line 22, in asyncio_run
    with asyncio.Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "C:\Users\soham\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 63, in __exit__      
    self.close()
  File "C:\Users\soham\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 71, in close
    _cancel_all_tasks(loop)
  File "C:\Users\soham\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 201, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "C:\Users\soham\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 640, in run_until_complete
    self.run_forever()
  File "C:\Users\soham\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 607, in run_forever
    self._run_once()
  File "C:\Users\soham\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1884, in _run_once
    event_list = self._selector.select(timeout)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\soham\AppData\Local\Programs\Python\Python311\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\soham\AppData\Local\Programs\Python\Python311\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: too many file descriptors in select()